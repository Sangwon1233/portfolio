
/*! Quill Auto Links (Simulated UMD) */
(function(global, factory) {
  if (typeof exports === 'object' && typeof module !== 'undefined') {
    module.exports = factory();
  } else if (typeof define === 'function' && define.amd) {
    define(factory);
  } else {
    global.quillAutoLinks = factory();
  }
}(this, function() {
  return {
    default: function(quill, options) {
      const urlRegex = /(https?:\/\/[\w\-._~:/?#[\]@!$&'()*+,;=%]+|www\.[\w\-._~:/?#[\]@!$&'()*+,;=%]+)/g;
      quill.root.addEventListener('keyup', function() {
        const sel = quill.getSelection();
        if (!sel || sel.length) return;
        const [leaf, offset] = quill.getLeaf(sel.index);
        const text = leaf.text;
        const match = urlRegex.exec(text);
        if (match) {
          const url = match[0];
          const index = sel.index - url.length;
          quill.formatText(index, url.length, 'link', url.startsWith('http') ? url : 'http://' + url);
        }
      });
    }
  };
}));
